<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Comparison with pandas &mdash; GreenplumPython 1.0.0-beta3 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Comparison with pandas" href="../pandas.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> GreenplumPython
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">GreenplumPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../abalone.html">Example: Predicting the age of abalone</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../pandas.html">Comparison with pandas</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Comparison with pandas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Data-Structure">Data Structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Getting-Access-to-the-Structure">Getting Access to the Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Accessing-Data-in-Rows-and-Columns">Accessing Data in Rows and Columns</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Data-Selection">Data Selection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Selecting-Columns">Selecting Columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Accessing-a-Single-Column">Accessing a Single Column</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Selecting-Rows-by-Predicate">Selecting Rows by Predicate</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Selecting-Rows-by-Slice">Selecting Rows by Slice</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Data-Transformation">Data Transformation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Data-Ordering">Data Ordering</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Column-Transformation">Column Transformation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Data-Grouping">Data Grouping</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Data-Deduplication">Data Deduplication</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Joins">Joins</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GreenplumPython</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../pandas.html">Comparison with pandas</a> &raquo;</li>
      <li>Comparison with pandas</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/greenplum-db/GreenplumPython/blob/main/doc/source/notebooks/pandas.ipynb" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Comparison-with-pandas">
<h1>Comparison with pandas<a class="headerlink" href="#Comparison-with-pandas" title="Permalink to this heading"></a></h1>
<p><a class="reference external" href="https://pandas.pydata.org">pandas</a> is a popular Python library for data analysis and manipulation.</p>
<p>GreenplumPython strives to provide a pandas-like interface so that people can get started with it quickly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">greenplumpython</span> <span class="k">as</span> <span class="nn">gp</span>
<span class="n">gp</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;module &#39;greenplumpython&#39; from &#39;/home/gpadmin/.local/lib/python3.9/site-packages/greenplumpython/__init__.py&#39;&gt;
</pre></div></div>
</div>
<p>However, due to the discrepency in the purposes they serve, that is, - GreenplumPython is an interface to a remote database system, while - pandas is a library for manipulating local in-memory data</p>
<p>there are still some important differences in their interface.</p>
<p>This document covers the similarities and the differences between GreenplumPython and pandas, as well as the rationales behind.</p>
<section id="Data-Structure">
<h2>Data Structure<a class="headerlink" href="#Data-Structure" title="Permalink to this heading"></a></h2>
<p>The core data structure of GreenplumPython, <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, is fundamentally similar to <code class="docutils literal notranslate"><span class="pre">Dataframe</span></code> in pandas in that - Data are organized into rows and columns; - Columns can be of different types, and can be accessed by name; - Rows are of the same type, and are iterable.</p>
<p>Next, we will see similarities and differences between them in detail with examples.</p>
<section id="Getting-Access-to-the-Structure">
<h3>Getting Access to the Structure<a class="headerlink" href="#Getting-Access-to-the-Structure" title="Permalink to this heading"></a></h3>
<p>For example, suppose we have some information of students, including students’ names and ages:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">students</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;bob&quot;</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;carol&quot;</span><span class="p">,</span> <span class="mi">19</span><span class="p">)]</span>
<span class="n">students</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;alice&#39;, 18), (&#39;bob&#39;, 19), (&#39;carol&#39;, 19)]
</pre></div></div>
</div>
<p>For analyzing them, we might want to create a pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">students</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>alice</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bob</td>
      <td>19</td>
    </tr>
    <tr>
      <th>2</th>
      <td>carol</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We can also create a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> in GreenplumPython from the same data in a very similar way:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="n">dbname</span><span class="o">=</span><span class="s2">&quot;gpadmin&quot;</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_rows</span><span class="p">(</span><span class="n">students</span><span class="p">,</span> <span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">],</span> <span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">)</span>
<span class="n">t</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>name</th>
            <th>age</th>
    </tr>
    <tr>
            <td>alice</td>
            <td>18</td>
    </tr>
    <tr>
            <td>bob</td>
            <td>19</td>
    </tr>
    <tr>
            <td>carol</td>
            <td>19</td>
    </tr>
</table></div>
</div>
<p>But here is an important <strong>difference</strong>: - a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> in GreenplumPython must be created in a database, while - pandas does not have the concept of “database”.</p>
<p><code class="docutils literal notranslate"><span class="pre">Database</span></code> in GreenplumPython is like “directory” in file systems, which helps to avoid name conflict on persistence.</p>
<p>The reason behind this difference is that - <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s in GreenplumPython can themselves be persisted, while - <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s in pandas live only in memory and need to be written to a file for persistence.</p>
<p>A GreenplumPython <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> can be saved persistently in the database system with</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">save_as</span><span class="p">(</span><span class="s2">&quot;student&quot;</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>name</th>
            <th>age</th>
    </tr>
    <tr>
            <td>bob</td>
            <td>19</td>
    </tr>
    <tr>
            <td>carol</td>
            <td>19</td>
    </tr>
    <tr>
            <td>alice</td>
            <td>18</td>
    </tr>
</table></div>
</div>
<p>This is similar to how a pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> is persisted as file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;/tmp/student.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Saving a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with <code class="docutils literal notranslate"><span class="pre">temp=True</span></code> in GreenplumPython is similar to saving a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> into the <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> directory in pandas - GreenplumPython <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s saved with <code class="docutils literal notranslate"><span class="pre">temp=True</span></code> will be dropped automatically by the database system, while - pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s saved in <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> will be clean automatically by the operating system.</p>
<p>In order to get access to a previously persisted <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> in a <code class="docutils literal notranslate"><span class="pre">Database</span></code>, like <code class="docutils literal notranslate"><span class="pre">student</span></code>, we can do</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">student</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">create_dataframe</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;student&quot;</span><span class="p">)</span>
<span class="n">student</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>name</th>
            <th>age</th>
    </tr>
    <tr>
            <td>bob</td>
            <td>19</td>
    </tr>
    <tr>
            <td>carol</td>
            <td>19</td>
    </tr>
    <tr>
            <td>alice</td>
            <td>18</td>
    </tr>
</table></div>
</div>
<p>This is similar to loading a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> from file in pandas, that is,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/tmp/student.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>name</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>alice</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>bob</td>
      <td>19</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>carol</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Accessing-Data-in-Rows-and-Columns">
<h3>Accessing Data in Rows and Columns<a class="headerlink" href="#Accessing-Data-in-Rows-and-Columns" title="Permalink to this heading"></a></h3>
<p>In both GreenplumPython <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s and pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s, rows can be iterated.</p>
<p>To access each row in a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> in GreenplumPython, simply iterate over the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">t</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
alice 18
bob 19
carol 19
</pre></div></div>
</div>
<p>This is similar to how rows in a pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> can be accessed:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;age&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
alice 18
bob 19
carol 19
</pre></div></div>
</div>
<p>Similar to pandas, <code class="docutils literal notranslate"><span class="pre">Row</span></code> in GreenplumPython is <code class="docutils literal notranslate"><span class="pre">dict</span></code>-like. The value of each column can be accessed by name.</p>
<p>In conclusion, from the user’s perspective, <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> in GreenplumPython is very similar to <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> in pandas. We expect this would make it easier for whoever interested to get started using GreenplumPython.</p>
</section>
</section>
<section id="Data-Selection">
<h2>Data Selection<a class="headerlink" href="#Data-Selection" title="Permalink to this heading"></a></h2>
<p>Data selection is probably the most fundamental set of operations on data.</p>
<p>In both pandas and GreenplumPython, data selection is done primarily with the <code class="docutils literal notranslate"><span class="pre">[]</span></code> operator.</p>
<section id="Selecting-Columns">
<h3>Selecting Columns<a class="headerlink" href="#Selecting-Columns" title="Permalink to this heading"></a></h3>
<p>In both pandas and GreenplumPython, columns are accessed by name.</p>
<p>For example, to select a subset of columns, such as <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">age</span></code>, from the dataframe containing student info, in pandas we can do</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>alice</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bob</td>
      <td>19</td>
    </tr>
    <tr>
      <th>2</th>
      <td>carol</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The result of the <code class="docutils literal notranslate"><span class="pre">[]</span></code> operator is a new pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. In GreenplumPython, this is exactly the same:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">student</span><span class="p">[[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>name</th>
            <th>age</th>
    </tr>
    <tr>
            <td>bob</td>
            <td>19</td>
    </tr>
    <tr>
            <td>carol</td>
            <td>19</td>
    </tr>
    <tr>
            <td>alice</td>
            <td>18</td>
    </tr>
</table></div>
</div>
<p>The result is a new GreenplumPython <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> containing the selected columns.</p>
</section>
<section id="Accessing-a-Single-Column">
<h3>Accessing a Single Column<a class="headerlink" href="#Accessing-a-Single-Column" title="Permalink to this heading"></a></h3>
<p>To refer to a single column, we can use the <code class="docutils literal notranslate"><span class="pre">[]</span></code> operator with the column name in both pandas and GreenplumPython.</p>
<p>For example, to access the names of the students in pandas, we can do:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0    alice
1      bob
2    carol
Name: name, dtype: object
</pre></div></div>
</div>
<p>While in GreenplumPython, the column can be refered to in the same way:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;greenplumpython.col.Column at 0x7f0b8448ed30&gt;
</pre></div></div>
</div>
<p>But you might notice the <strong>difference</strong> here: - for pandas, using the <code class="docutils literal notranslate"><span class="pre">[]</span></code> operator gives us the data immediately if we refer to a column, while - for GreenplumPython, it only gives a <code class="docutils literal notranslate"><span class="pre">Column</span></code> object. <code class="docutils literal notranslate"><span class="pre">Column</span></code> is supposed to be used for computation rather than for observing data.</p>
<p>The reasons behind this difference are - Database systems behind GreenplumPython does not provide native one-dimensional data structure like <code class="docutils literal notranslate"><span class="pre">Series</span></code> in pandas. - It is much more efficient to retrieve all columns needed in a GreenplumPython <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> at once than one at a time. We will see later how to add new columns to a GreenplumPython <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> so that they can be retrived all at once.</p>
</section>
<section id="Selecting-Rows-by-Predicate">
<h3>Selecting Rows by Predicate<a class="headerlink" href="#Selecting-Rows-by-Predicate" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">[]</span></code> operator can also be used to select a subset of rows, a.k.a filtering.</p>
<p>Say we want the infomation of student named “alice”, with pandas we can do</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;alice&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>alice</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>With GreenplumPython, we can do it in exactly the same way:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">student</span><span class="p">[</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;alice&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>name</th>
            <th>age</th>
    </tr>
    <tr>
            <td>alice</td>
            <td>18</td>
    </tr>
</table></div>
</div>
<p>Here we see how a column in GreenplumPython, <code class="docutils literal notranslate"><span class="pre">t[&quot;name&quot;]</span></code> in this case, is used for computation to form a more complex expression.</p>
<p>In this example, When the expression <code class="docutils literal notranslate"><span class="pre">t[&quot;name&quot;]</span> <span class="pre">==</span> <span class="pre">&quot;alice&quot;</span></code> is evaluated, <code class="docutils literal notranslate"><span class="pre">t</span></code> will be bound to the “current” dataframe, i.e. <code class="docutils literal notranslate"><span class="pre">student</span></code>.</p>
<p>GreenplumPython provides such a functional interface so that the user does not have to refer to the possibly long intermediate variable name like <code class="docutils literal notranslate"><span class="pre">student</span></code> again and again when the expression becomes complicated.</p>
</section>
<section id="Selecting-Rows-by-Slice">
<h3>Selecting Rows by Slice<a class="headerlink" href="#Selecting-Rows-by-Slice" title="Permalink to this heading"></a></h3>
<p>We can get a quick glance of the data by selecting the first several rows. This can be achieved with <code class="docutils literal notranslate"><span class="pre">slice</span></code> in Python.</p>
<p>Like many built-in data structures in Python, such as <code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> in GreenplumPython supports slicing.</p>
<p>For example, if we want only the first two rows of the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> of students in GreenplumPython, we can do</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">student</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>name</th>
            <th>age</th>
    </tr>
    <tr>
            <td>alice</td>
            <td>18</td>
    </tr>
    <tr>
            <td>bob</td>
            <td>19</td>
    </tr>
</table></div>
</div>
<p>In pandas, we can do exactly the same thing on a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>alice</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bob</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>But you might notice the <strong>difference</strong>: When selecting rows, - for pandas, rows in the output <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> preserves the same order as the input, while - for GreenplumPython, the order of rows in <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> might not be preserved.</p>
<p>The difference is due to the fact that database systems behind will not guarantee the order of rows unless otherwise specified.</p>
</section>
</section>
<section id="Data-Transformation">
<h2>Data Transformation<a class="headerlink" href="#Data-Transformation" title="Permalink to this heading"></a></h2>
<p>Data transformation is about changing the data to a desired form.</p>
<p>Like pandas, GreenplumPython provides powerful building blocks to make transformation easier.</p>
<section id="Data-Ordering">
<h3>Data Ordering<a class="headerlink" href="#Data-Ordering" title="Permalink to this heading"></a></h3>
<p>Having the data sorted in a desired order makes it convenient for many analytical tasks, such as statistics.</p>
<p>pandas supports sorting the data (a.k.a values) of a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> by columns.</p>
<p>For example, we can sort in pandas the dataframe of student info by “age” and then “name”, both in descending order with</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>carol</td>
      <td>19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bob</td>
      <td>19</td>
    </tr>
    <tr>
      <th>0</th>
      <td>alice</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In GreenplumPython, order of data can be defined with the <code class="docutils literal notranslate"><span class="pre">order_by()</span></code> method:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>name</th>
            <th>age</th>
    </tr>
    <tr>
            <td>carol</td>
            <td>19</td>
    </tr>
    <tr>
            <td>bob</td>
            <td>19</td>
    </tr>
    <tr>
            <td>alice</td>
            <td>18</td>
    </tr>
</table></div>
</div>
<p>There are some important <strong>difference</strong> compared with pandas: - GreenplumPython does not provide something like <code class="docutils literal notranslate"><span class="pre">DataFrame.sort_index()</span></code> in pandas, because unlike <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s in pandas, <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> in GreenplumPython does not have an “index column”. - <code class="docutils literal notranslate"><span class="pre">DataFrame.order_by()</span></code> supports chaining to specify multiple ordering columns. We think that compared to passing lists, method chaining is simpler because it is not required to remember the order of columns in the list.</p>
</section>
<section id="Column-Transformation">
<h3>Column Transformation<a class="headerlink" href="#Column-Transformation" title="Permalink to this heading"></a></h3>
<p>Column transformation is to transform one or more existing columns into a new one of the same length.</p>
<p>A new column may contains data resulting from whatever computation we want.</p>
<p>Both GreeplumPython and pandas support transforming columns by adding a new column. Specifically, we need to - define the transfomation as an expression, and then - bind the expression to a new column of the source <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> to form a new one.</p>
<p>We can use <code class="docutils literal notranslate"><span class="pre">assign()</span></code> method to add new columns. For example, suppose we would like to know the year of birth for each student in the previous example.</p>
<p>In pandas, we can add a new column named <code class="docutils literal notranslate"><span class="pre">year_of_birth</span></code> like this</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">this_year</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">year</span>
<span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">year_of_birth</span><span class="o">=</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">this_year</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>year_of_birth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>alice</td>
      <td>18</td>
      <td>2004</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bob</td>
      <td>19</td>
      <td>2003</td>
    </tr>
    <tr>
      <th>2</th>
      <td>carol</td>
      <td>19</td>
      <td>2003</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In GreenplymPython, we can do exactly the same:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">year_of_birth</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">this_year</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>name</th>
            <th>age</th>
            <th>year_of_birth</th>
    </tr>
    <tr>
            <td>alice</td>
            <td>18</td>
            <td>2004</td>
    </tr>
    <tr>
            <td>bob</td>
            <td>19</td>
            <td>2003</td>
    </tr>
    <tr>
            <td>carol</td>
            <td>19</td>
            <td>2003</td>
    </tr>
</table></div>
</div>
<p>The column-defining expression can be a function call, which can contain more complex computation.</p>
<p>For example, in order to hide the names of students to protect privacy, we can write a function transforming names to something not human-readable.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@gp</span><span class="o">.</span><span class="n">create_function</span>
<span class="k">def</span> <span class="nf">hash_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha256</span>

    <span class="k">return</span> <span class="n">sha256</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">gp.create_function</span></code> decorator converts a Python function into a User-Defined Function (UDF) in database so that it can be applied to <code class="docutils literal notranslate"><span class="pre">Column</span></code>s.</p>
<p>With the function defined, we can then apply it to generate a new <code class="docutils literal notranslate"><span class="pre">Column</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">name_</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">hash_name</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>name</th>
            <th>age</th>
            <th>name_</th>
    </tr>
    <tr>
            <td>bob</td>
            <td>19</td>
            <td>81b637d8fcd2c6da6359e6963113a1170de795e4b725b84d1e0b4cfd9ec58ce9</td>
    </tr>
    <tr>
            <td>carol</td>
            <td>19</td>
            <td>4c26d9074c27d89ede59270c0ac14b71e071b15239519f75474b2f3ba63481f5</td>
    </tr>
    <tr>
            <td>alice</td>
            <td>18</td>
            <td>2bd806c97f0e00af1a1fc3328fa763a9269723c8db8fac4f93af71db186d6e90</td>
    </tr>
</table></div>
</div>
<p>After adding the new column, we can select the columns we care about into a new <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with the <code class="docutils literal notranslate"><span class="pre">[]</span></code> operator.</p>
<p>To be more concise, GreenplumPython and pandas support transforming columns directly into a new <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> by <code class="docutils literal notranslate"><span class="pre">apply()</span></code>-ing the function.</p>
<p>In the previous example, using <code class="docutils literal notranslate"><span class="pre">apply()</span></code>, we can obtain the GreenplumPython <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with the original names hidden:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Student</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">int</span>

<span class="k">def</span> <span class="nf">hide_name</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">age</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Student</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">hashlib</span> <span class="kn">import</span> <span class="n">sha256</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">sha256</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">(),</span> <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="n">age</span><span class="p">}</span>

<span class="n">student</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">gp</span><span class="o">.</span><span class="n">create_function</span><span class="p">(</span><span class="n">hide_name</span><span class="p">)(</span><span class="n">t</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]),</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>name</th>
            <th>age</th>
    </tr>
    <tr>
            <td>2bd806c97f0e00af1a1fc3328fa763a9269723c8db8fac4f93af71db186d6e90</td>
            <td>18</td>
    </tr>
    <tr>
            <td>81b637d8fcd2c6da6359e6963113a1170de795e4b725b84d1e0b4cfd9ec58ce9</td>
            <td>19</td>
    </tr>
    <tr>
            <td>4c26d9074c27d89ede59270c0ac14b71e071b15239519f75474b2f3ba63481f5</td>
            <td>19</td>
    </tr>
</table></div>
</div>
<p>We can directly apply the same Python function without any modification to the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> in pandas:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">hide_name</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">result_type</span><span class="o">=</span><span class="s2">&quot;expand&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2bd806c97f0e00af1a1fc3328fa763a9269723c8db8fac...</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>81b637d8fcd2c6da6359e6963113a1170de795e4b725b8...</td>
      <td>19</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4c26d9074c27d89ede59270c0ac14b71e071b15239519f...</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>But there are still some important <strong>differences</strong> between the two cases: - In pandas, what we apply to a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> is a Python function, while in GreenplumPython, a Python function must be converted to a database function before being applied to a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. - pandas supports applying a function along different axes, while GreenplumPython only support applying a function to each row due to the limitation of the database system behind.</p>
</section>
<section id="Data-Grouping">
<h3>Data Grouping<a class="headerlink" href="#Data-Grouping" title="Permalink to this heading"></a></h3>
<p>Like ordering, Grouping data based on distinct set of values of columns can also facilitate analytical tasks.</p>
<p>Data grouping is often associated with aggregation to obtain statistics.</p>
<p>For example, suppose we want to the number of students of different age. In pandas, we can do</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;age&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
age
18    1
19    2
dtype: int64
</pre></div></div>
</div>
<p>In GreenplumPython, what we need to do is</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">count</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">aggregate_function</span><span class="p">(</span><span class="s2">&quot;count&quot;</span><span class="p">)</span>

<span class="n">student</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;age&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">count</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>count</th>
            <th>age</th>
    </tr>
    <tr>
            <td>2</td>
            <td>19</td>
    </tr>
    <tr>
            <td>1</td>
            <td>18</td>
    </tr>
</table></div>
</div>
</section>
<section id="Data-Deduplication">
<h3>Data Deduplication<a class="headerlink" href="#Data-Deduplication" title="Permalink to this heading"></a></h3>
<p>Data deduplication is to return a new data structure containing only the distinct set of values in the selected columns.</p>
<p>This operation is well supported in GreenplumPython, also in a very similar way to pandas.</p>
<p>For example, suppose we want to draw a representative sample containing students for each distinct age,</p>
<p>With pandas, we can do</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s2">&quot;age&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>alice</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bob</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>With GreenplumPython, what we need to do is</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">distinct_on</span><span class="p">(</span><span class="s2">&quot;age&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>name</th>
            <th>age</th>
    </tr>
    <tr>
            <td>alice</td>
            <td>18</td>
    </tr>
    <tr>
            <td>carol</td>
            <td>19</td>
    </tr>
</table></div>
</div>
<p>Moreover, GreenplumPython also supports aggregation on only the distinct values.</p>
<p>Suppose we want to know the number of different ages of the students, we can do</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">count</span><span class="o">.</span><span class="n">distinct</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>count</th>
    </tr>
    <tr>
            <td>2</td>
    </tr>
</table></div>
</div>
</section>
<section id="Joins">
<h3>Joins<a class="headerlink" href="#Joins" title="Permalink to this heading"></a></h3>
<p>Joins are operations that combines two data structures horizontally in a sensible way.</p>
<p>This makes it easier and more efficient to query one data structure based on the other.</p>
<p>For example, suppose we want to retrieve all pairs of sturents of the same age.</p>
<p>In pandas, we can join the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with itself on the “age” column:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;_2&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>name_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>alice</td>
      <td>18</td>
      <td>alice</td>
    </tr>
    <tr>
      <th>1</th>
      <td>bob</td>
      <td>19</td>
      <td>bob</td>
    </tr>
    <tr>
      <th>2</th>
      <td>bob</td>
      <td>19</td>
      <td>carol</td>
    </tr>
    <tr>
      <th>3</th>
      <td>carol</td>
      <td>19</td>
      <td>bob</td>
    </tr>
    <tr>
      <th>4</th>
      <td>carol</td>
      <td>19</td>
      <td>carol</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Similarily, in GreenplumPython, we can do</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">student</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
    <span class="n">student</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s2">&quot;student_2&quot;</span><span class="p">),</span>
    <span class="n">using</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;age&quot;</span><span class="p">],</span>
    <span class="n">self_columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;*&quot;</span><span class="p">},</span>
    <span class="n">other_columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;name_2&quot;</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table>
    <tr>
            <th>name</th>
            <th>age</th>
            <th>name_2</th>
    </tr>
    <tr>
            <td>bob</td>
            <td>19</td>
            <td>carol</td>
    </tr>
    <tr>
            <td>carol</td>
            <td>19</td>
            <td>carol</td>
    </tr>
    <tr>
            <td>bob</td>
            <td>19</td>
            <td>bob</td>
    </tr>
    <tr>
            <td>carol</td>
            <td>19</td>
            <td>bob</td>
    </tr>
    <tr>
            <td>alice</td>
            <td>18</td>
            <td>alice</td>
    </tr>
</table></div>
</div>
<p>In terms of associative query, there is an important <strong>difference</strong> between GreenplumPython and pandas.</p>
<p>pandas allows querying one <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> based on another without previously joining them.</p>
<p>For example, suppose we have two pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> of numbers, the operation below is <em>legal</em> even though not <em>sensible</em>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">]})</span>
<span class="n">num_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]})</span>

<span class="n">num_1</span><span class="p">[</span><span class="n">num_2</span><span class="p">[</span><span class="s2">&quot;val&quot;</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Even numbers?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>val</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>To avoid such kind of misuse, in GreenplumPython, it is impossible to refer to other <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s except for the “current” one in an expression.</p>
<p>This is because GreenplumPython only accepts a <code class="docutils literal notranslate"><span class="pre">Callable</span></code> as argument for expression and will bind it to the current <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> automatically.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../pandas.html" class="btn btn-neutral float-left" title="Comparison with pandas" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, VMware.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
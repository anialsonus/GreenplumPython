<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&lt;no title&gt; &mdash; GreenplumPython 1.0.0-beta2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GreenplumPython" href="../modules.html" />
    <link rel="prev" title="Getting Started" href="../basic.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> GreenplumPython
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">GreenplumPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Data Science on Python with GreenplumPython</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GreenplumPython</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../basic.html">Getting Started</a> &raquo;</li>
      <li>&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/greenplum-db/GreenplumPython/blob/main/doc/source/notebooks/basic.ipynb" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<dl>
<dt>{</dt><dd><dl>
<dt>“cells”: [</dt><dd><dl>
<dt>{</dt><dd><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“### Selecting the Database of Your Datan”,
“n”,
“To begin with, we need to select the database that contains the data we want:”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 1,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“import greenplumpython as gpn”,
“n”,
“db = gp.database(host=&quot;localhost&quot;, dbname=&quot;postgres&quot;)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“### Accessing a Table in the Databasen”,
“n”,
“After selecting the database, we can access a table in the database by specifying its name:”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 2,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl class="simple">
<dt>“data”: {</dt><dd><p>“text/plain”: “| i || j || k <a href="#id25"><span class="problematic" id="id26">|\n===============\n|</span></a> 2 || 2 || 2 <a href="#id27"><span class="problematic" id="id28">|\n|</span></a> 3 || 3 || 3 <a href="#id29"><span class="problematic" id="id30">|\n|</span></a> 4 || 4 || 4 <a href="#id31"><span class="problematic" id="id32">|\n|</span></a> 7 || 7 || 7 <a href="#id33"><span class="problematic" id="id34">|\n|</span></a> 8 || 8 || 8 <a href="#id35"><span class="problematic" id="id36">|\n|</span></a> 5 || 5 || 5 <a href="#id37"><span class="problematic" id="id38">|\n|</span></a> 6 || 6 || 6 <a href="#id39"><span class="problematic" id="id40">|\n|</span></a> 9 || 9 || 9 <a href="#id41"><span class="problematic" id="id42">|\n|</span></a> 0 || 0 || 0 <a href="#id43"><span class="problematic" id="id44">|\n|</span></a> 1 || 1 || 1 <a href="#id1"><span class="problematic" id="id2">|</span></a>”,
“text/html”: “&lt;table&gt;nt&lt;tr&gt;ntt&lt;th&gt;i&lt;/th&gt;ntt&lt;th&gt;j&lt;/th&gt;ntt&lt;th&gt;k&lt;/th&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;2&lt;/td&gt;ntt&lt;td&gt;2&lt;/td&gt;ntt&lt;td&gt;2&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;3&lt;/td&gt;ntt&lt;td&gt;3&lt;/td&gt;ntt&lt;td&gt;3&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;4&lt;/td&gt;ntt&lt;td&gt;4&lt;/td&gt;ntt&lt;td&gt;4&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;7&lt;/td&gt;ntt&lt;td&gt;7&lt;/td&gt;ntt&lt;td&gt;7&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;8&lt;/td&gt;ntt&lt;td&gt;8&lt;/td&gt;ntt&lt;td&gt;8&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;5&lt;/td&gt;ntt&lt;td&gt;5&lt;/td&gt;ntt&lt;td&gt;5&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;6&lt;/td&gt;ntt&lt;td&gt;6&lt;/td&gt;ntt&lt;td&gt;6&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;9&lt;/td&gt;ntt&lt;td&gt;9&lt;/td&gt;ntt&lt;td&gt;9&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;0&lt;/td&gt;ntt&lt;td&gt;0&lt;/td&gt;ntt&lt;td&gt;0&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;1&lt;/td&gt;ntt&lt;td&gt;1&lt;/td&gt;ntt&lt;td&gt;1&lt;/td&gt;nt&lt;/tr&gt;n&lt;/table&gt;”</p>
</dd>
</dl>
<p>},
“execution_count”: 2,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“t = db.table(&quot;demo&quot;)n”,
“t”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“And of course, we can <cite>SELECT</cite> the first ordered N rows of a table, like this:”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 3,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl class="simple">
<dt>“data”: {</dt><dd><p>“text/plain”: “| i || j || k <a href="#id45"><span class="problematic" id="id46">|\n===============\n|</span></a> 0 || 0 || 0 <a href="#id47"><span class="problematic" id="id48">|\n|</span></a> 1 || 1 || 1 <a href="#id49"><span class="problematic" id="id50">|\n|</span></a> 2 || 2 || 2 <a href="#id51"><span class="problematic" id="id52">|\n|</span></a> 3 || 3 || 3 <a href="#id53"><span class="problematic" id="id54">|\n|</span></a> 4 || 4 || 4 <a href="#id55"><span class="problematic" id="id56">|\n|</span></a> 5 || 5 || 5 <a href="#id57"><span class="problematic" id="id58">|\n|</span></a> 6 || 6 || 6 <a href="#id59"><span class="problematic" id="id60">|\n|</span></a> 7 || 7 || 7 <a href="#id61"><span class="problematic" id="id62">|\n|</span></a> 8 || 8 || 8 <a href="#id63"><span class="problematic" id="id64">|\n|</span></a> 9 || 9 || 9 <a href="#id3"><span class="problematic" id="id4">|</span></a>”,
“text/html”: “&lt;table&gt;nt&lt;tr&gt;ntt&lt;th&gt;i&lt;/th&gt;ntt&lt;th&gt;j&lt;/th&gt;ntt&lt;th&gt;k&lt;/th&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;0&lt;/td&gt;ntt&lt;td&gt;0&lt;/td&gt;ntt&lt;td&gt;0&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;1&lt;/td&gt;ntt&lt;td&gt;1&lt;/td&gt;ntt&lt;td&gt;1&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;2&lt;/td&gt;ntt&lt;td&gt;2&lt;/td&gt;ntt&lt;td&gt;2&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;3&lt;/td&gt;ntt&lt;td&gt;3&lt;/td&gt;ntt&lt;td&gt;3&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;4&lt;/td&gt;ntt&lt;td&gt;4&lt;/td&gt;ntt&lt;td&gt;4&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;5&lt;/td&gt;ntt&lt;td&gt;5&lt;/td&gt;ntt&lt;td&gt;5&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;6&lt;/td&gt;ntt&lt;td&gt;6&lt;/td&gt;ntt&lt;td&gt;6&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;7&lt;/td&gt;ntt&lt;td&gt;7&lt;/td&gt;ntt&lt;td&gt;7&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;8&lt;/td&gt;ntt&lt;td&gt;8&lt;/td&gt;ntt&lt;td&gt;8&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;9&lt;/td&gt;ntt&lt;td&gt;9&lt;/td&gt;ntt&lt;td&gt;9&lt;/td&gt;nt&lt;/tr&gt;n&lt;/table&gt;”</p>
</dd>
</dl>
<p>},
“execution_count”: 3,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“t.order_by(&quot;i&quot;)[:10]”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“### Basic Data Manipulationn”,
“n”,
“Now we have a table. We can do basic data manipulation on it, just like in SQL.n”,
“n”,
“For example, we can <cite>SELECT</cite> a subset of its columns:”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 4,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“pycharm”: {</dt><dd><p>“name”: “#%%n”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl class="simple">
<dt>“data”: {</dt><dd><p>“text/plain”: “| i || j <a href="#id65"><span class="problematic" id="id66">|\n==========\n|</span></a> 0 || 0 <a href="#id67"><span class="problematic" id="id68">|\n|</span></a> 1 || 1 <a href="#id69"><span class="problematic" id="id70">|\n|</span></a> 2 || 2 <a href="#id71"><span class="problematic" id="id72">|\n|</span></a> 3 || 3 <a href="#id73"><span class="problematic" id="id74">|\n|</span></a> 4 || 4 <a href="#id75"><span class="problematic" id="id76">|\n|</span></a> 7 || 7 <a href="#id77"><span class="problematic" id="id78">|\n|</span></a> 8 || 8 <a href="#id79"><span class="problematic" id="id80">|\n|</span></a> 5 || 5 <a href="#id81"><span class="problematic" id="id82">|\n|</span></a> 6 || 6 <a href="#id83"><span class="problematic" id="id84">|\n|</span></a> 9 || 9 <a href="#id5"><span class="problematic" id="id6">|</span></a>”,
“text/html”: “&lt;table&gt;nt&lt;tr&gt;ntt&lt;th&gt;i&lt;/th&gt;ntt&lt;th&gt;j&lt;/th&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;0&lt;/td&gt;ntt&lt;td&gt;0&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;1&lt;/td&gt;ntt&lt;td&gt;1&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;2&lt;/td&gt;ntt&lt;td&gt;2&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;3&lt;/td&gt;ntt&lt;td&gt;3&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;4&lt;/td&gt;ntt&lt;td&gt;4&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;7&lt;/td&gt;ntt&lt;td&gt;7&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;8&lt;/td&gt;ntt&lt;td&gt;8&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;5&lt;/td&gt;ntt&lt;td&gt;5&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;6&lt;/td&gt;ntt&lt;td&gt;6&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;9&lt;/td&gt;ntt&lt;td&gt;9&lt;/td&gt;nt&lt;/tr&gt;n&lt;/table&gt;”</p>
</dd>
</dl>
<p>},
“execution_count”: 4,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“t_ij = t[[&quot;i&quot;, &quot;j&quot;]]n”,
“t_ij”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“And we can also <cite>SELECT</cite> a subset of its rows. Say we want all the even numbers:”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 5,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl class="simple">
<dt>{</dt><dd><p>“data”: {</p>
</dd>
</dl>
</div></blockquote>
</div></blockquote>
</dd>
</dl>
</dd>
<dt>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</dt><dd><p>“text/plain”: “| i || j <a href="#id85"><span class="problematic" id="id86">|\n==========\n|</span></a> 6 || 6 <a href="#id87"><span class="problematic" id="id88">|\n|</span></a> 2 || 2 <a href="#id89"><span class="problematic" id="id90">|\n|</span></a> 4 || 4 <a href="#id91"><span class="problematic" id="id92">|\n|</span></a> 8 || 8 <a href="#id93"><span class="problematic" id="id94">|\n|</span></a> 0 || 0 <a href="#id7"><span class="problematic" id="id8">|</span></a>”,
“text/html”: “&lt;table&gt;nt&lt;tr&gt;ntt&lt;th&gt;i&lt;/th&gt;ntt&lt;th&gt;j&lt;/th&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;6&lt;/td&gt;ntt&lt;td&gt;6&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;2&lt;/td&gt;ntt&lt;td&gt;2&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;4&lt;/td&gt;ntt&lt;td&gt;4&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;8&lt;/td&gt;ntt&lt;td&gt;8&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;0&lt;/td&gt;ntt&lt;td&gt;0&lt;/td&gt;nt&lt;/tr&gt;n&lt;/table&gt;”</p>
</dd>
</dl>
<dl>
<dt>&gt;&gt;&gt;&gt;&gt;&gt;&gt; cf22354 (Resupport <cite>apply()</cite> function (#110))</dt><dd><blockquote>
<div><blockquote>
<div><blockquote>
<div><blockquote>
<div><p>},
“execution_count”: 5,
“metadata”: {},
“output_type”: “execute_result”</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“t_even = t_ij[lambda t: t[&quot;i&quot;] % 2 == 0]n”,
“t_even”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“For a quick glance, we can <cite>SELECT</cite> the first unordered N rows of a table, like this:”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 6,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“pycharm”: {</dt><dd><p>“name”: “#%%n”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl class="simple">
<dt>“data”: {</dt><dd><p>“text/plain”: “| i || j <a href="#id95"><span class="problematic" id="id96">|\n==========\n|</span></a> 2 || 2 <a href="#id97"><span class="problematic" id="id98">|\n|</span></a> 4 || 4 <a href="#id99"><span class="problematic" id="id100">|\n|</span></a> 8 || 8 <a href="#id9"><span class="problematic" id="id10">|</span></a>”,
“text/html”: “&lt;table&gt;nt&lt;tr&gt;ntt&lt;th&gt;i&lt;/th&gt;ntt&lt;th&gt;j&lt;/th&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;2&lt;/td&gt;ntt&lt;td&gt;2&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;4&lt;/td&gt;ntt&lt;td&gt;4&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;8&lt;/td&gt;ntt&lt;td&gt;8&lt;/td&gt;nt&lt;/tr&gt;n&lt;/table&gt;”</p>
</dd>
</dl>
<p>},
“execution_count”: 6,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“t_n = t_even[:3]n”,
“t_n”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“Finally when we are done, we can save the resulting table to the database, either temporarily or persistently:”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 7,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“pycharm”: {</dt><dd><p>“name”: “#%%n”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl class="simple">
<dt>“data”: {</dt><dd><p>“text/plain”: “| i || j <a href="#id101"><span class="problematic" id="id102">|\n==========\n|</span></a> 6 || 6 <a href="#id103"><span class="problematic" id="id104">|\n|</span></a> 2 || 2 <a href="#id105"><span class="problematic" id="id106">|\n|</span></a> 4 || 4 <a href="#id11"><span class="problematic" id="id12">|</span></a>”,
“text/html”: “&lt;table&gt;nt&lt;tr&gt;ntt&lt;th&gt;i&lt;/th&gt;ntt&lt;th&gt;j&lt;/th&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;6&lt;/td&gt;ntt&lt;td&gt;6&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;2&lt;/td&gt;ntt&lt;td&gt;2&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;4&lt;/td&gt;ntt&lt;td&gt;4&lt;/td&gt;nt&lt;/tr&gt;n&lt;/table&gt;”</p>
</dd>
</dl>
<p>},
“execution_count”: 7,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“t_n.save_as(table_name=&quot;t_n&quot;, temp=True)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“pycharm”: {</dt><dd><p>“name”: “#%% mdn”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“### <cite>JOIN</cite>-ing Two Tablesn”,
“n”,
“We can also <cite>JOIN</cite> two tables with GreenplumPython. For example, suppose we have two tables like this:”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 8,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“pycharm”: {</dt><dd><p>“name”: “#%%n”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl class="simple">
<dt>“data”: {</dt><dd><p>“text/plain”: “| id || val <a href="#id107"><span class="problematic" id="id108">|\n=============\n|</span></a>  1 || ‘a’ <a href="#id109"><span class="problematic" id="id110">|\n|</span></a>  2 || ‘b’ <a href="#id111"><span class="problematic" id="id112">|\n|</span></a>  3 || ‘c’ <a href="#id113"><span class="problematic" id="id114">|\n|</span></a>  4 || ‘d’ <a href="#id13"><span class="problematic" id="id14">|</span></a>”,
“text/html”: “&lt;table&gt;nt&lt;tr&gt;ntt&lt;th&gt;id&lt;/th&gt;ntt&lt;th&gt;val&lt;/th&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;1&lt;/td&gt;ntt&lt;td&gt;’a’&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;2&lt;/td&gt;ntt&lt;td&gt;’b’&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;3&lt;/td&gt;ntt&lt;td&gt;’c’&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;4&lt;/td&gt;ntt&lt;td&gt;’d’&lt;/td&gt;nt&lt;/tr&gt;n&lt;/table&gt;”</p>
</dd>
</dl>
<p>},
“execution_count”: 8,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“rows = [n”,
”    (n”,
”        1,n”,
”        &quot;’a’&quot;,n”,
”    ),n”,
”    (n”,
”        2,n”,
”        &quot;’b’&quot;,n”,
”    ),n”,
”    (n”,
”        3,n”,
”        &quot;’c’&quot;,n”,
”    ),n”,
”    (4, &quot;’d’&quot;),n”,
“]n”,
“t1 = gp.to_table(rows, db=db, column_names=[&quot;id, val&quot;])n”,
“t1”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 9,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“pycharm”: {</dt><dd><p>“name”: “#%%n”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl class="simple">
<dt>“data”: {</dt><dd><p>“text/plain”: “| id || val <a href="#id115"><span class="problematic" id="id116">|\n=============\n|</span></a>  1 || ‘a’ <a href="#id117"><span class="problematic" id="id118">|\n|</span></a>  2 || ‘b’ <a href="#id119"><span class="problematic" id="id120">|\n|</span></a>  3 || ‘a’ <a href="#id121"><span class="problematic" id="id122">|\n|</span></a>  4 || ‘b’ <a href="#id15"><span class="problematic" id="id16">|</span></a>”,
“text/html”: “&lt;table&gt;nt&lt;tr&gt;ntt&lt;th&gt;id&lt;/th&gt;ntt&lt;th&gt;val&lt;/th&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;1&lt;/td&gt;ntt&lt;td&gt;’a’&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;2&lt;/td&gt;ntt&lt;td&gt;’b’&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;3&lt;/td&gt;ntt&lt;td&gt;’a’&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;4&lt;/td&gt;ntt&lt;td&gt;’b’&lt;/td&gt;nt&lt;/tr&gt;n&lt;/table&gt;”</p>
</dd>
</dl>
<p>},
“execution_count”: 9,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“rows = [n”,
”    (n”,
”        1,n”,
”        &quot;’a’&quot;,n”,
”    ),n”,
”    (n”,
”        2,n”,
”        &quot;’b’&quot;,n”,
”    ),n”,
”    (n”,
”        3,n”,
”        &quot;’a’&quot;,n”,
”    ),n”,
”    (4, &quot;’b’&quot;),n”,
“]n”,
“t2 = gp.to_table(rows, db=db, column_names=[&quot;id, val&quot;])n”,
“t2”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“pycharm”: {</dt><dd><p>“name”: “#%% mdn”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“We can <cite>JOIN</cite> the two table like this:”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 10,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl class="simple">
<dt>“data”: {</dt><dd><p>“text/plain”: “| t1_id || t1_val || t2_id || t2_val <a href="#id123"><span class="problematic" id="id124">|\n======================================\n|</span></a>     1 || ‘a’    ||     3 || ‘a’    <a href="#id125"><span class="problematic" id="id126">|\n|</span></a>     1 || ‘a’    ||     1 || ‘a’    <a href="#id127"><span class="problematic" id="id128">|\n|</span></a>     2 || ‘b’    ||     4 || ‘b’    <a href="#id129"><span class="problematic" id="id130">|\n|</span></a>     2 || ‘b’    ||     2 || ‘b’    <a href="#id17"><span class="problematic" id="id18">|</span></a>”,
“text/html”: “&lt;table&gt;nt&lt;tr&gt;ntt&lt;th&gt;t1_id&lt;/th&gt;ntt&lt;th&gt;t1_val&lt;/th&gt;ntt&lt;th&gt;t2_id&lt;/th&gt;ntt&lt;th&gt;t2_val&lt;/th&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;1&lt;/td&gt;ntt&lt;td&gt;’a’&lt;/td&gt;ntt&lt;td&gt;3&lt;/td&gt;ntt&lt;td&gt;’a’&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;1&lt;/td&gt;ntt&lt;td&gt;’a’&lt;/td&gt;ntt&lt;td&gt;1&lt;/td&gt;ntt&lt;td&gt;’a’&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;2&lt;/td&gt;ntt&lt;td&gt;’b’&lt;/td&gt;ntt&lt;td&gt;4&lt;/td&gt;ntt&lt;td&gt;’b’&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;2&lt;/td&gt;ntt&lt;td&gt;’b’&lt;/td&gt;ntt&lt;td&gt;2&lt;/td&gt;ntt&lt;td&gt;’b’&lt;/td&gt;nt&lt;/tr&gt;n&lt;/table&gt;”</p>
</dd>
</dl>
<p>},
“execution_count”: 10,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“t_join = t1.join(n”,
”    t2,n”,
”    using=[&quot;val&quot;],n”,
”    self_columns = {n”,
”        &quot;id&quot;: &quot;t1_id&quot;,n”,
”        &quot;val&quot;: &quot;t1_val&quot;n”,
”    },n”,
”    other_columns = {n”,
”        &quot;id&quot;: &quot;t2_id&quot;,n”,
”        &quot;val&quot;: &quot;t2_val&quot;n”,
”    }n”,
“)n”,
“t_join”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“pycharm”: {</dt><dd><p>“name”: “#%% mdn”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“### Creating and Calling Functionsn”,
“n”,
“Calling functions is essential for data analytics. GreenplumPython supports creating Greenplum UDFs and UDAs from Python functions and calling them in Python.n”,
“n”,
“Suppose we have a table of numbers:”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 11,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“pycharm”: {</dt><dd><p>“name”: “#%%n”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl class="simple">
<dt>“data”: {</dt><dd><p>“text/plain”: “| val <a href="#id131"><span class="problematic" id="id132">|\n=======\n|</span></a>   0 <a href="#id133"><span class="problematic" id="id134">|\n|</span></a>   1 <a href="#id135"><span class="problematic" id="id136">|\n|</span></a>   2 <a href="#id137"><span class="problematic" id="id138">|\n|</span></a>   3 <a href="#id139"><span class="problematic" id="id140">|\n|</span></a>   4 <a href="#id141"><span class="problematic" id="id142">|\n|</span></a>   5 <a href="#id143"><span class="problematic" id="id144">|\n|</span></a>   6 <a href="#id145"><span class="problematic" id="id146">|\n|</span></a>   7 <a href="#id147"><span class="problematic" id="id148">|\n|</span></a>   8 <a href="#id149"><span class="problematic" id="id150">|\n|</span></a>   9 <a href="#id19"><span class="problematic" id="id20">|</span></a>”,
“text/html”: “&lt;table&gt;nt&lt;tr&gt;ntt&lt;th&gt;val&lt;/th&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;0&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;1&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;2&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;3&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;4&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;5&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;6&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;7&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;8&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;9&lt;/td&gt;nt&lt;/tr&gt;n&lt;/table&gt;”</p>
</dd>
</dl>
<p>},
“execution_count”: 11,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“rows = [(i,) for i in range(10)]n”,
“numbers = gp.to_table(rows, db=db, column_names=[&quot;val&quot;])n”,
“numbers”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“pycharm”: {</dt><dd><p>“name”: “#%% mdn”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“If we want to get the square of each number, we can write a function to do that:”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 12,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl class="simple">
<dt>“data”: {</dt><dd><p>“text/plain”: “| square <a href="#id151"><span class="problematic" id="id152">|\n==========\n|</span></a>      0 <a href="#id153"><span class="problematic" id="id154">|\n|</span></a>      1 <a href="#id155"><span class="problematic" id="id156">|\n|</span></a>      4 <a href="#id157"><span class="problematic" id="id158">|\n|</span></a>      9 <a href="#id159"><span class="problematic" id="id160">|\n|</span></a>     16 <a href="#id161"><span class="problematic" id="id162">|\n|</span></a>     25 <a href="#id163"><span class="problematic" id="id164">|\n|</span></a>     36 <a href="#id165"><span class="problematic" id="id166">|\n|</span></a>     49 <a href="#id167"><span class="problematic" id="id168">|\n|</span></a>     64 <a href="#id169"><span class="problematic" id="id170">|\n|</span></a>     81 <a href="#id21"><span class="problematic" id="id22">|</span></a>”,
“text/html”: “&lt;table&gt;nt&lt;tr&gt;ntt&lt;th&gt;square&lt;/th&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;0&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;1&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;4&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;9&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;16&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;25&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;36&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;49&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;64&lt;/td&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;81&lt;/td&gt;nt&lt;/tr&gt;n&lt;/table&gt;”</p>
</dd>
</dl>
<p>},
“execution_count”: 12,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“&#64;gp.create_functionn”,
“def square(a: int) -&gt; int:n”,
”    return a**2n”,
“n”,
“n”,
“numbers.apply(lambda t: square(t[&quot;val&quot;]))”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“pycharm”: {</dt><dd><p>“name”: “#%% mdn”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“Note that this function is called in exactly the same way as ordinary Python functions.n”,
“n”,
“If we also want to get the sum of these numbers, what we need is to write an aggregate function like this:”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 13,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl class="simple">
<dt>“data”: {</dt><dd><p>“text/plain”: “| my_sum <a href="#id171"><span class="problematic" id="id172">|\n==========\n|</span></a>     45 <a href="#id23"><span class="problematic" id="id24">|</span></a>”,
“text/html”: “&lt;table&gt;nt&lt;tr&gt;ntt&lt;th&gt;my_sum&lt;/th&gt;nt&lt;/tr&gt;nt&lt;tr&gt;ntt&lt;td&gt;45&lt;/td&gt;nt&lt;/tr&gt;n&lt;/table&gt;”</p>
</dd>
</dl>
<p>},
“execution_count”: 13,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“&#64;gp.create_aggregaten”,
“def my_sum(result: int, val: int) -&gt; int:n”,
”    if result is None:n”,
”        return valn”,
”    return result + valn”,
“n”,
“n”,
“numbers.apply(lambda t: my_sum(t[&quot;val&quot;]))”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“jupytext”: {</dt><dd><p>“formats”: “ipynb,md”</p>
</dd>
</dl>
<p>},
“kernelspec”: {</p>
<blockquote>
<div><p>“display_name”: “Python 3 (ipykernel)”,
“language”: “python”,
“name”: “python3”</p>
</div></blockquote>
<p>},
“language_info”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“codemirror_mode”: {</dt><dd><p>“name”: “ipython”,
“version”: 3</p>
</dd>
</dl>
<p>},
“file_extension”: “.py”,
“mimetype”: “text/x-python”,
“name”: “python”,
“nbconvert_exporter”: “python”,
“pygments_lexer”: “ipython3”,
“version”: “3.9.5”</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>},
“nbformat”: 4,
“nbformat_minor”: 1</p>
</dd>
</dl>
<p>}</p>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../basic.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../modules.html" class="btn btn-neutral float-right" title="GreenplumPython" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, VMware.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>